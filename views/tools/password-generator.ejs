<%- include('../partials/head', { title: title }) %>
<%- include('../partials/navbar') %>
<main class="main-content">

<style>
    /* Component Styles */
    .component-section {
        margin-bottom: 4rem;
        padding: 2rem;
        border: 1px solid var(--border-color);
        background: var(--bg-color);
    }

    /* 2️⃣ Page Identity */
    .identity-header {
        text-align: center;
        margin-bottom: 3rem;
    }
    .category-tag {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        background: var(--primary-color);
        color: white;
        font-size: 0.875rem;
        text-transform: uppercase;
        margin-bottom: 1rem;
        font-weight: bold;
        border-radius: 4px;
    }
    .identity-title {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        line-height: 1.2;
    }
    .identity-subtitle {
        font-size: 1.25rem;
        color: var(--text-light);
        max-width: 800px;
        margin: 0 auto;
    }

    /* 3️⃣ Authority & Trust */
    .authority-block {
        display: flex;
        justify-content: center;
        gap: 3rem;
        flex-wrap: wrap;
        text-align: left;
        border-bottom: 1px solid #eee;
        padding-bottom: 2rem;
    }
    .auth-profile {
        display: flex;
        align-items: center;
        gap: 1rem;
    }
    .auth-avatar {
        width: 50px;
        height: 50px;
        background: var(--primary-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        color: white;
        font-size: 1.2rem;
    }
    .trust-indicator {
        display: flex;
        align-items: center;
        color: var(--text-light);
        font-size: 0.9rem;
        background: #f0f9f0;
        padding: 0.5rem 1rem;
        border-radius: 20px;
    }

    /* 4️⃣ Core Tool */
    .tool-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
    }
    @media (max-width: 768px) {
        .tool-container {
            grid-template-columns: 1fr;
        }
    }
    .tool-input-group {
        margin-bottom: 1.5rem;
    }
    .tool-input-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: bold;
    }
    .password-display {
        width: 100%;
        padding: 1.5rem;
        font-size: 1.5rem;
        border: 2px solid var(--border-color);
        font-family: monospace;
        text-align: center;
        background: #f8f9fa;
        word-break: break-all;
        margin-bottom: 1rem;
    }
    .length-slider {
        width: 100%;
        margin: 1rem 0;
    }
    .length-value {
        text-align: center;
        font-size: 1.2rem;
        font-weight: bold;
        color: var(--primary-color);
    }
    .toggles-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1rem;
        margin-top: 1rem;
    }
    .toggle-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        padding: 0.5rem;
        border: 1px solid #eee;
        border-radius: 4px;
        transition: background 0.2s;
    }
    .toggle-item:hover {
        background: #f5f5f5;
    }
    .toggle-item input[type="checkbox"] {
        width: 20px;
        height: 20px;
        cursor: pointer;
    }
    .generate-btn {
        width: 100%;
        padding: 1rem;
        font-size: 1.2rem;
        background: var(--primary-color);
        color: white;
        border: none;
        cursor: pointer;
        font-weight: bold;
        transition: background 0.2s;
    }
    .generate-btn:hover {
        background: var(--primary-color-dark);
    }
    .copy-btn {
        padding: 0.5rem 1rem;
        background: #28a745;
        color: white;
        border: none;
        cursor: pointer;
        font-weight: bold;
    }
    .result-card {
        background: #f8f9fa;
        padding: 1.5rem;
        border: 1px solid #eee;
    }
    .metric-large {
        font-size: 2.5rem;
        font-weight: bold;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
    }
    .metric-label {
        text-transform: uppercase;
        font-size: 0.8rem;
        color: var(--text-light);
        letter-spacing: 1px;
    }
    .strength-meter {
        height: 8px;
        background: #eee;
        margin: 1rem 0;
        width: 100%;
        position: relative;
        border-radius: 4px;
    }
    .strength-fill {
        height: 100%;
        background: var(--primary-color);
        width: 0%;
        transition: width 0.3s ease, background-color 0.3s ease;
        border-radius: 4px;
    }
    .entropy-display {
        font-family: monospace;
        font-size: 1.1rem;
        color: var(--text-light);
    }

    /* 5️⃣ Guidance & 6️⃣ Educational */
    .content-article {
        max-width: 800px;
        margin: 0 auto;
        line-height: 1.8;
    }
    .content-article h2 {
        font-size: 1.8rem;
        margin: 2rem 0 1rem;
    }
    .content-article h3 {
        font-size: 1.4rem;
        margin: 1.5rem 0 0.8rem;
    }
    .content-article p {
        margin-bottom: 1rem;
    }
    .content-article table {
        width: 100%;
        border-collapse: collapse;
        margin: 1rem 0;
    }
    .content-article th,
    .content-article td {
        padding: 0.75rem;
        border: 1px solid #ddd;
        text-align: left;
    }
    .content-article th {
        background: #f5f5f5;
    }

    /* 7️⃣ FAQ */
    .faq-grid {
        display: grid;
        gap: 1.5rem;
    }
    .faq-item h3 {
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
    }
    .faq-item p {
        color: var(--text-light);
        font-size: 0.95rem;
    }

    /* 8️⃣ Discovery */
    .discovery-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
    }
    .tool-card {
        padding: 1.5rem;
        border: 1px solid #eee;
        text-decoration: none;
        color: inherit;
        display: block;
        transition: var(--transition);
        background: white;
    }
    .tool-card:hover {
        border-color: var(--primary-color);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .tool-card h3 {
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
    }
    .tool-card p {
        font-size: 0.85rem;
        color: var(--text-light);
    }
</style>

<div class="container">
    
    <!-- 2️⃣ Page Identity Component -->
    <section class="identity-header">
        <span class="category-tag">Security & Privacy Tools</span>
        <h1 class="identity-title">Ultimate Secure Random Password Generator</h1>
        <p class="identity-subtitle">Create complex, unhackable passwords with customizable rules for maximum account protection.</p>
    </section>

    <!-- 3️⃣ Authority & Trust Component -->
    <section class="component-section" style="border:none; padding-top:0;">
        <div class="authority-block">
            <div class="auth-profile">
                <div class="auth-avatar">MK</div>
                <div>
                    <div style="font-weight:bold;">Michael Kovacs, CISSP</div>
                    <div style="font-size:0.8rem; color:var(--text-light);">Senior Security Engineer</div>
                </div>
            </div>
            <div class="auth-profile">
                <div class="auth-avatar">LA</div>
                <div>
                    <div style="font-weight:bold;">Dr. Layla Al-Rashid</div>
                    <div style="font-size:0.8rem; color:var(--text-light);">PhD, Cryptography</div>
                </div>
            </div>
            <div class="trust-indicator">
                <span style="margin-right:0.5rem;">✓</span>
                Scientifically reviewed by 500,000+ users
            </div>
        </div>
    </section>

    <!-- 4️⃣ Core Tool Component (Main Tool) -->
    <section class="component-section" id="tool-interface">
        <div class="tool-container">
            <!-- Inputs -->
            <div class="tool-inputs">
                <div class="tool-input-group">
                    <label>Password Length</label>
                    <input type="range" id="lengthSlider" class="length-slider" min="6" max="128" value="16">
                    <div class="length-value"><span id="lengthValue">16</span> characters</div>
                </div>

                <div class="tool-input-group">
                    <label>Character Options</label>
                    <div class="toggles-grid">
                        <label class="toggle-item">
                            <input type="checkbox" id="chkUpper" checked> 
                            <span>Include Uppercase Letters (A-Z)</span>
                        </label>
                        <label class="toggle-item">
                            <input type="checkbox" id="chkLower" checked> 
                            <span>Include Lowercase Letters (a-z)</span>
                        </label>
                        <label class="toggle-item">
                            <input type="checkbox" id="chkNumber" checked> 
                            <span>Include Numbers (0-9)</span>
                        </label>
                        <label class="toggle-item">
                            <input type="checkbox" id="chkSymbol" checked> 
                            <span>Include Special Symbols (!@#$%^&*)</span>
                        </label>
                        <label class="toggle-item">
                            <input type="checkbox" id="chkExcludeSimilar" checked> 
                            <span>Exclude Similar Characters (i, l, 1, L, o, 0, O)</span>
                        </label>
                    </div>
                </div>

                <button class="generate-btn" id="generateBtn">
                    Generate Secure Password
                </button>
            </div>

            <!-- Outputs -->
            <div class="tool-outputs">
                <div class="result-card">
                    <div class="metric-label">Generated Password</div>
                    <div class="password-display" id="passwordOutput">Click "Generate" to create</div>
                    <button class="copy-btn" id="copyBtn" style="display:none;">Copy to Clipboard</button>

                    <div style="margin-top:2rem;">
                        <div class="metric-label">Password Strength</div>
                        <div class="strength-meter">
                            <div class="strength-fill" id="strengthBar"></div>
                        </div>
                        <div style="text-align:right; font-weight:bold;" id="strengthLabel">-</div>
                    </div>

                    <div style="margin-top:1.5rem;">
                        <div class="metric-label">Entropy (Randomness)</div>
                        <div class="entropy-display" id="entropyDisplay">- bits</div>
                    </div>

                    <div style="margin-top:1.5rem;">
                        <div class="metric-label">Estimated Crack Time</div>
                        <div style="font-family:monospace; font-size:1.1rem; margin-top:0.5rem;" id="crackTimeDisplay">-</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logic Explanation -->
        <div style="margin-top:2rem; padding:1.5rem; background:#f8f9fa; border-left:4px solid var(--primary-color);">
            <h3 style="margin-bottom:1rem;">How It Works</h3>
            <p><strong>Conceptual Logic:</strong> The generator uses the browser's cryptographically secure random number generator (<code>crypto.getRandomValues</code>) to select characters from a pool based on your selected options. Each character is chosen independently with uniform probability distribution.</p>
            
            <p><strong>Key Assumptions:</strong></p>
            <ul style="margin-left:2rem; margin-top:0.5rem;">
                <li>The browser's RNG provides sufficient entropy for password generation</li>
                <li>Character selection is truly random and unbiased</li>
                <li>The generated password is used immediately and not stored</li>
            </ul>

            <p><strong>Limitations:</strong> This tool runs client-side and doesn't transmit passwords over the network. However, passwords displayed on screen could be captured by shoulder-surfing or screen recording software. Always clear your clipboard after copying.</p>
        </div>
    </section>

    <!-- 5️⃣ Guidance Content Component -->
    <section class="component-section">
        <div class="content-article">
            <h2>How to Use Secure Random Password Generator</h2>
            
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:2rem;">
                <div>
                    <h3>1. Set Your Requirements</h3>
                    <p>Adjust the password length slider (6-128 characters). Most security experts recommend at least 12-16 characters for strong protection. Select which character types to include based on the requirements of the service you're creating the password for.</p>
                </div>
                <div>
                    <h3>2. Generate & Copy</h3>
                    <p>Click "Generate Secure Password" to create a unique password. The tool instantly displays the password along with its strength rating and entropy calculation. Use the copy button to save it to your clipboard.</p>
                </div>
            </div>
            
            <h3>How to Interpret Results</h3>
            <p><strong>Strength Rating:</strong> Ranges from Weak to Excellent based on length and character variety.</p>
            <p><strong>Entropy:</strong> Measured in bits. Higher is better. 60+ bits is considered strong; 80+ bits is excellent.</p>
            <p><strong>Crack Time:</strong> Estimated time for a brute-force attack using modern GPU arrays (10 billion guesses/second).</p>
            
            <div style="background:#fff3cd; padding:1.5rem; border-left:4px solid #ffc107; margin-top:1.5rem;">
                <strong>Accuracy & Responsibility Disclaimer:</strong> This tool generates passwords using industry-standard cryptographic random number generators. However, the security of your accounts also depends on proper password storage (password managers), avoiding phishing attacks, and enabling two-factor authentication. We are not responsible for passwords that are intercepted, stolen, or compromised due to factors outside the generation process.
            </div>
        </div>
    </section>

    <!-- 6️⃣ Educational Content Component -->
    <section class="component-section">
        <div class="content-article">
            <h2>The Science Behind Secure Password Generation</h2>
            
            <h3>What Makes a Password Secure?</h3>
            <p>Password security is fundamentally about entropy—the measure of uncertainty or randomness. A password with high entropy is mathematically difficult to guess, even with powerful computing resources. The entropy of a password depends on two factors: the size of the character pool used and the length of the password.</p>

            <h3>Cryptographically Secure Random Number Generation</h3>
            <p>Not all random number generators are equal. Standard <code>Math.random()</code> functions use pseudo-random algorithms that can be predictable. Our generator uses the browser's <code>crypto.getRandomValues()</code> API, which provides cryptographically secure random bytes sourced from the operating system's entropy pool. This ensures that generated passwords cannot be predicted or reproduced.</p>

            <h3>Character Pool Mathematics</h3>
            <p>The strength of a password grows exponentially with each additional character. Here's how different character sets contribute to security:</p>
            
            <table>
                <tr>
                    <th>Character Set</th>
                    <th>Pool Size</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td>Lowercase only</td>
                    <td>26</td>
                    <td>abcdef</td>
                </tr>
                <tr>
                    <td>Lowercase + Uppercase</td>
                    <td>52</td>
                    <td>aBcDeF</td>
                </tr>
                <tr>
                    <td>+ Numbers</td>
                    <td>62</td>
                    <td>a1B2c3</td>
                </tr>
                <tr>
                    <td>+ Symbols</td>
                    <td>94</td>
                    <td>a1!B2@c3#</td>
                </tr>
            </table>

            <p>A 12-character password using all character types has 94^12 possible combinations—more than the number of grains of sand on Earth.</p>

            <h3>The Similar Characters Problem</h3>
            <p>Characters like lowercase 'l', uppercase 'I', and the number '1' look nearly identical in many fonts. The same applies to 'O', 'o', and '0'. When you need to manually type a password (rather than copy-paste), these similarities cause errors. Our "Exclude Similar Characters" option removes these ambiguous characters from the pool, improving usability without significantly reducing security.</p>

            <h3>Brute Force Attack Reality</h3>
            <p>Modern password cracking uses specialized hardware (GPUs and ASICs) capable of testing billions of passwords per second. A password with 40 bits of entropy can be cracked in hours; 80 bits requires centuries. Our calculator estimates crack time assuming an attacker has access to high-performance hardware and knows your character set preferences.</p>
        </div>
    </section>

    <!-- 7️⃣ FAQ Component -->
    <section class="component-section">
        <h2 style="text-align:center; margin-bottom:2rem;">Frequently Asked Questions</h2>
        <div class="faq-grid">
            <div class="faq-item">
                <h3>What is a cryptographically secure random password?</h3>
                <p>A cryptographically secure password is generated using a random number generator that meets security standards for cryptographic operations. Unlike standard random functions, CSPRNGs (Cryptographically Secure Pseudo-Random Number Generators) are unpredictable and cannot be reproduced even if part of the output is known.</p>
            </div>
            <div class="faq-item">
                <h3>How many characters should a strong password have?</h3>
                <p>For most online accounts, 12-16 characters is sufficient. For high-security applications (banking, encryption keys), use 20+ characters. Each additional character exponentially increases cracking difficulty.</p>
            </div>
            <div class="faq-item">
                <h3>Can a random password generator be hacked?</h3>
                <p>The generator itself cannot be "hacked" in the traditional sense since it runs client-side in your browser and doesn't store or transmit passwords. However, if your device is compromised with malware, generated passwords could be intercepted at the system level. Always keep your operating system and browser updated.</p>
            </div>
            <div class="faq-item">
                <h3>Why should I exclude similar characters in passwords?</h3>
                <p>Similar-looking characters (i, l, 1, L, o, 0, O) cause transcription errors when manually typing passwords. While this option slightly reduces the character pool, the usability improvement outweighs the minimal security reduction for most use cases.</p>
            </div>
            <div class="faq-item">
                <h3>How often should I update my generated passwords?</h3>
                <p>NIST guidelines no longer recommend mandatory periodic password changes. Instead, change passwords when: (1) You suspect compromise, (2) The service reports a data breach, (3) You shared the password, or (4) You used it on an untrusted device. Strong, unique passwords can remain secure for years.</p>
            </div>
            <div class="faq-item">
                <h3>Is it safe to use generated passwords?</h3>
                <p>Yes, generated passwords are typically much safer than human-created ones, which often contain patterns, dictionary words, or personal information. Generated passwords have maximum randomness and no predictable structure.</p>
            </div>
            <div class="faq-item">
                <h3>Should I include special characters?</h3>
                <p>Yes, when possible. Special characters significantly expand the character pool and increase entropy. However, some older systems have limitations. Our tool allows you to customize which character types to include based on the requirements of the service you're using.</p>
            </div>
            <div class="faq-item">
                <h3>How is entropy calculated?</h3>
                <p>Entropy is calculated as: <strong>E = L × log₂(R)</strong>, where L is password length and R is the size of the character pool. For example, a 16-character password using 94 possible characters has approximately 105 bits of entropy.</p>
            </div>
        </div>
    </section>

    <!-- 8️⃣ Internal Discovery Component -->
    <section class="component-section" style="border:none;">
        <h2 style="margin-bottom:1.5rem;">Related Security Tools</h2>
        <div class="discovery-grid">
            <a href="/tools/team-password-vault" class="tool-card">
                <h3>Team Password Vault</h3>
                <p>Securely manage and share team credentials with RBAC.</p>
            </a>
            <a href="/tools/entropy-calculator" class="tool-card">
                <h3>Entropy Calculator</h3>
                <p>Scientifically measure password strength and complexity.</p>
            </a>
            <a href="/tools/diceware-passphrase" class="tool-card">
                <h3>Diceware Passphrase</h3>
                <p>Generate memorable, high-entropy passphrases.</p>
            </a>
            <a href="/tools/password-expiration" class="tool-card">
                <h3>Password Expiration</h3>
                <p>Calculate optimal rotation schedules for security.</p>
            </a>
            <a href="/tools/breach-checker" class="tool-card">
                <h3>Breach Checker</h3>
                <p>Check if your credentials have been compromised.</p>
            </a>
            <a href="/tools/2fa-generator" class="tool-card">
                <h3>2FA Generator</h3>
                <p>Generate time-based one-time passwords for MFA.</p>
            </a>
        </div>
    </section>

</div>
</main>

<script>
    // Secure Random Password Generator Logic
    document.addEventListener('DOMContentLoaded', () => {
        const lengthSlider = document.getElementById('lengthSlider');
        const lengthValue = document.getElementById('lengthValue');
        const generateBtn = document.getElementById('generateBtn');
        const copyBtn = document.getElementById('copyBtn');
        const passwordOutput = document.getElementById('passwordOutput');
        const strengthBar = document.getElementById('strengthBar');
        const strengthLabel = document.getElementById('strengthLabel');
        const entropyDisplay = document.getElementById('entropyDisplay');
        const crackTimeDisplay = document.getElementById('crackTimeDisplay');

        const chkUpper = document.getElementById('chkUpper');
        const chkLower = document.getElementById('chkLower');
        const chkNumber = document.getElementById('chkNumber');
        const chkSymbol = document.getElementById('chkSymbol');
        const chkExcludeSimilar = document.getElementById('chkExcludeSimilar');

        // Character sets
        const UPPERCASE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        const LOWERCASE = 'abcdefghijklmnopqrstuvwxyz';
        const NUMBERS = '0123456789';
        const SYMBOLS = '!@#$%^&*()_+-=[]{}|;:,.<>?';
        const SIMILAR = 'il1Lo0O';

        // Update length display
        lengthSlider.addEventListener('input', () => {
            lengthValue.textContent = lengthSlider.value;
        });

        // Generate password
        generateBtn.addEventListener('click', () => {
            const length = parseInt(lengthSlider.value);
            let charset = '';

            if (chkUpper.checked) charset += UPPERCASE;
            if (chkLower.checked) charset += LOWERCASE;
            if (chkNumber.checked) charset += NUMBERS;
            if (chkSymbol.checked) charset += SYMBOLS;

            if (chkExcludeSimilar.checked) {
                for (let char of SIMILAR) {
                    charset = charset.replace(char, '');
                }
            }

            if (charset.length === 0) {
                passwordOutput.textContent = 'Please select at least one character type';
                return;
            }

            // Generate using crypto.getRandomValues for security
            const password = generateSecurePassword(length, charset);
            passwordOutput.textContent = password;
            copyBtn.style.display = 'inline-block';

            // Calculate and display metrics
            const metrics = calculateMetrics(password, charset.length);
            updateMetrics(metrics);
        });

        // Copy to clipboard
        copyBtn.addEventListener('click', () => {
            navigator.clipboard.writeText(passwordOutput.textContent).then(() => {
                copyBtn.textContent = 'Copied!';
                setTimeout(() => {
                    copyBtn.textContent = 'Copy to Clipboard';
                }, 2000);
            });
        });

        function generateSecurePassword(length, charset) {
            const charsetArray = new Uint32Array(length);
            crypto.getRandomValues(charsetArray);
            
            let password = '';
            for (let i = 0; i < length; i++) {
                password += charset[charsetArray[i] % charset.length];
            }
            return password;
        }

        function calculateMetrics(password, poolSize) {
            const length = password.length;
            const entropy = length * Math.log2(poolSize);
            
            // Calculate crack time (assuming 10 billion guesses/sec for offline GPU attack)
            const combinations = Math.pow(poolSize, length);
            const seconds = combinations / 10000000000; // 10 billion/sec
            
            let strength, color, width;
            if (entropy < 40) {
                strength = 'Weak';
                color = '#d32f2f';
                width = '20%';
            } else if (entropy < 60) {
                strength = 'Fair';
                color = '#ff9800';
                width = '40%';
            } else if (entropy < 80) {
                strength = 'Good';
                color = '#ffc107';
                width = '60%';
            } else if (entropy < 100) {
                strength = 'Strong';
                color = '#4caf50';
                width = '80%';
            } else {
                strength = 'Excellent';
                color = '#2e7d32';
                width = '100%';
            }

            return { entropy, strength, color, width, seconds };
        }

        function updateMetrics(metrics) {
            entropyDisplay.textContent = Math.round(metrics.entropy) + ' bits';
            strengthLabel.textContent = metrics.strength;
            strengthLabel.style.color = metrics.color;
            strengthBar.style.width = metrics.width;
            strengthBar.style.backgroundColor = metrics.color;
            crackTimeDisplay.textContent = formatTime(metrics.seconds);
        }

        function formatTime(seconds) {
            if (seconds < 1) return 'Instant';
            if (seconds < 60) return Math.round(seconds) + ' seconds';
            if (seconds < 3600) return Math.round(seconds/60) + ' minutes';
            if (seconds < 86400) return Math.round(seconds/3600) + ' hours';
            if (seconds < 31536000) return Math.round(seconds/86400) + ' days';
            if (seconds < 3153600000) return Math.round(seconds/31536000) + ' years';
            if (seconds < 315360000000) return Math.round(seconds/3153600000) + ' centuries';
            return 'Millennia+';
        }

        // Ensure at least one checkbox is always checked
        [chkUpper, chkLower, chkNumber, chkSymbol].forEach(checkbox => {
            checkbox.addEventListener('change', () => {
                const checked = [chkUpper, chkLower, chkNumber, chkSymbol].filter(chk => chk.checked).length;
                if (checked === 0) {
                    checkbox.checked = true;
                    alert('At least one character type must be selected');
                }
            });
        });
    });
</script>

<%- include('../partials/footer') %>